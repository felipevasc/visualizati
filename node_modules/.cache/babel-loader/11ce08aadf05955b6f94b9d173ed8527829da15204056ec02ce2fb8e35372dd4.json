{"ast":null,"code":"var _jsxFileName = \"/opt/dev/visualizati/src/pages/Estrutura/index.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { URL_CONSULTA_UNIDADE, URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA, URL_SERVIDORES_ATI } from \"../../utils/constants\";\nimport { mapUnidade } from \"../../utils/maps\";\nimport { ORGAOS_SISP } from \"../../utils/ORGAOS_SISP\";\nimport Table from \"../../components/Table\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n//https://api.siorg.economia.gov.br/\n//https://portaldatransparencia.gov.br/download-de-dados/servidores\n//https://portaldatransparencia.gov.br/servidores/consulta/resultado?paginacaoSimples=true&tamanhoPagina=20&offset=0&direcaoOrdenacao=asc&colunaOrdenacao=nome&cargo=ANALISTA+EM+TECNOL+DA+INFORMACAO&colunasSelecionadas=detalhar%2Ctipo%2Ccpf%2Cnome%2CorgaoServidorLotacao%2Cmatricula%2Csituacao%2Cfuncao%2Ccargo%2Cquantidade&t=KmyUhhcHB12s9jx0mtMy&_=1751334998241\nconst Estrutura = () => {\n  _s();\n  const [unidades, setUnidades] = useState();\n  const [servidores, setServidores] = useState();\n  useEffect(() => {\n    const consultarServidores = async () => {\n      const req = await fetch(URL_SERVIDORES_ATI());\n      const r = await req.json();\n      setServidores(r.data);\n    };\n    consultarServidores();\n  }, []);\n  const cargosUnidade = async (codUnid, level) => {\n    var _r$unidade;\n    if (level > 4) {\n      return [];\n    }\n    const cargos = [];\n    const req = await fetch(URL_CONSULTA_UNIDADE(codUnid));\n    const r = await req.json();\n    if ((_r$unidade = r.unidade) !== null && _r$unidade !== void 0 && _r$unidade.cargos) {\n      cargos.push(r.unidade.cargos);\n    }\n    const req2 = await fetch(URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA(codUnid));\n    const r2 = await req2.json();\n    if (r2.unidades) {\n      const subunidades = mapUnidade(r2.unidades);\n      for (let i = 0; i < subunidades.length; i++) {\n        if (!subunidades[i].codigoUnidade || codUnid === Number(subunidades[i].codigoUnidade)) {\n          continue;\n        }\n        if (subunidades[i].codigoTipoUnidade === 'entidade' || subunidades[i].codigoTipoUnidade === 'entidade') {\n          const cargosUnidTmp = await cargosUnidade(Number(subunidades[i].codigoUnidade), level + 1);\n          cargos.push(cargosUnidTmp);\n        }\n      }\n    }\n    return cargos;\n  };\n  useEffect(() => {\n    const consultar = async () => {\n      var _r$unidades;\n      const req = await fetch(URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA(26));\n      const r = await req.json();\n      const unidadesTmp = mapUnidade(r === null || r === void 0 ? void 0 : (_r$unidades = r.unidades) === null || _r$unidades === void 0 ? void 0 : _r$unidades.filter(u => ORGAOS_SISP.map(o => o.sigla).includes(u.sigla)));\n      const unidadesComCollapse = unidadesTmp === null || unidadesTmp === void 0 ? void 0 : unidadesTmp.map(u => {\n        return {\n          collapse: '',\n          ...u\n        };\n      });\n      for (let i = 0; i < (unidadesComCollapse === null || unidadesComCollapse === void 0 ? void 0 : unidadesComCollapse.length); i++) {\n        var _unidadesComCollapse$;\n        if (!(unidadesComCollapse !== null && unidadesComCollapse !== void 0 && (_unidadesComCollapse$ = unidadesComCollapse[i]) !== null && _unidadesComCollapse$ !== void 0 && _unidadesComCollapse$.codigoUnidade)) {\n          continue;\n        }\n        const codUnid = Number(unidadesComCollapse[i].codigoUnidade);\n        const cargos = await cargosUnidade(codUnid, 0);\n        if (cargos) {\n          unidadesComCollapse[i].collapse = /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxWidth: '60%',\n              backgroundColor: '#aafa'\n            },\n            children: /*#__PURE__*/_jsxDEV(Table, {\n              data: cargos.map(c => {\n                var _c$instancias$length, _c$instancias;\n                return {\n                  cargo: c.denominacao,\n                  funcao: c.funcao,\n                  qtd: (_c$instancias$length = (_c$instancias = c.instancias) === null || _c$instancias === void 0 ? void 0 : _c$instancias.length) !== null && _c$instancias$length !== void 0 ? _c$instancias$length : 0\n                };\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 114\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 55\n          }, this);\n        }\n      }\n      setUnidades(unidadesComCollapse);\n    };\n    consultar();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      data: unidades !== null && unidades !== void 0 ? unidades : []\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n_s(Estrutura, \"jZH/GASisNgcgzs2nU3dQval42A=\");\n_c = Estrutura;\nexport default Estrutura;\nvar _c;\n$RefreshReg$(_c, \"Estrutura\");","map":{"version":3,"names":["useEffect","useState","URL_CONSULTA_UNIDADE","URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA","URL_SERVIDORES_ATI","mapUnidade","ORGAOS_SISP","Table","jsxDEV","_jsxDEV","Fragment","_Fragment","Estrutura","_s","unidades","setUnidades","servidores","setServidores","consultarServidores","req","fetch","r","json","data","cargosUnidade","codUnid","level","_r$unidade","cargos","unidade","push","req2","r2","subunidades","i","length","codigoUnidade","Number","codigoTipoUnidade","cargosUnidTmp","consultar","_r$unidades","unidadesTmp","filter","u","map","o","sigla","includes","unidadesComCollapse","collapse","_unidadesComCollapse$","style","maxWidth","backgroundColor","children","c","_c$instancias$length","_c$instancias","cargo","denominacao","funcao","qtd","instancias","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/opt/dev/visualizati/src/pages/Estrutura/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\nimport { URL_CONSULTA_UNIDADE, URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA, URL_SERVIDORES_ATI } from \"../../utils/constants\";\nimport { Unidade } from \"../../types/Unidade\";\nimport { mapUnidade } from \"../../utils/maps\";\nimport { ORGAOS_SISP } from \"../../utils/ORGAOS_SISP\";\nimport Table from \"../../components/Table\";\nimport { Servidor } from \"../../types/Servidor\";\n\n//https://api.siorg.economia.gov.br/\n//https://portaldatransparencia.gov.br/download-de-dados/servidores\n//https://portaldatransparencia.gov.br/servidores/consulta/resultado?paginacaoSimples=true&tamanhoPagina=20&offset=0&direcaoOrdenacao=asc&colunaOrdenacao=nome&cargo=ANALISTA+EM+TECNOL+DA+INFORMACAO&colunasSelecionadas=detalhar%2Ctipo%2Ccpf%2Cnome%2CorgaoServidorLotacao%2Cmatricula%2Csituacao%2Cfuncao%2Ccargo%2Cquantidade&t=KmyUhhcHB12s9jx0mtMy&_=1751334998241\nconst Estrutura = () => {\n    const [unidades, setUnidades] = useState<Unidade[]>();\n    const [servidores, setServidores] = useState<Servidor[]>();\n\n    useEffect(() => {\n        const consultarServidores = async () => {\n            const req = await fetch(URL_SERVIDORES_ATI());\n            const r = await req.json();\n            setServidores(r.data)\n        }\n        consultarServidores();\n    }, [])\n\n    const cargosUnidade = async (codUnid: number, level: number): Promise<any[]> => {\n        if (level > 4) {\n            return []\n        }\n        const cargos: any[] = [];\n        const req = await fetch(URL_CONSULTA_UNIDADE(codUnid));\n        const r = await req.json();\n        if (r.unidade?.cargos) {\n            cargos.push(r.unidade.cargos);\n        }\n        const req2 = await fetch(URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA(codUnid))\n        const r2 = await req2.json();\n        if (r2.unidades) {\n            const subunidades = mapUnidade(r2.unidades);\n            for (let i = 0; i < subunidades.length; i++) {\n                if (!subunidades[i].codigoUnidade || codUnid === Number(subunidades[i].codigoUnidade)) {\n                    continue;\n                }\n                if (subunidades[i].codigoTipoUnidade === 'entidade' || subunidades[i].codigoTipoUnidade === 'entidade') {\n                    const cargosUnidTmp = await cargosUnidade(Number(subunidades[i].codigoUnidade), level + 1)\n                    cargos.push(cargosUnidTmp)\n                }\n            }\n        }\n        return cargos\n    }\n\n    useEffect(() => {\n        const consultar = async () => {\n\n            const req = await fetch(URL_ESTRUTURA_ORGANIZACIONAL_RESUMIDA(26))\n            const r = await req.json();\n            const unidadesTmp = mapUnidade(r?.unidades?.filter((u: Unidade) => ORGAOS_SISP.map(o => o.sigla).includes(u.sigla)));\n            \n\n            const unidadesComCollapse = unidadesTmp?.map(u => {\n                return {collapse: '' as React.ReactNode, ...u }\n            });\n            for (let i = 0; i < unidadesComCollapse?.length; i++) {\n                if (!unidadesComCollapse?.[i]?.codigoUnidade) {\n                    continue\n                }\n                const codUnid = Number(unidadesComCollapse[i].codigoUnidade);\n                \n                const cargos = await cargosUnidade(codUnid, 0)\n\n                if (cargos) {\n                    unidadesComCollapse[i].collapse = <div style={{ maxWidth: '60%', backgroundColor: '#aafa' }}><Table data={cargos.map((c: any) => ({ cargo: c.denominacao, funcao: c.funcao, qtd: c.instancias?.length ?? 0 }))} /></div> \n                }\n            }\n\n            setUnidades(unidadesComCollapse);\n        }\n        consultar()\n    }, [])\n\n    return <>\n        <Table data={unidades ?? []} />\n    </>\n}\n\nexport default Estrutura"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}